package org.penforge.backend.pentestTemplates;

import lombok.AllArgsConstructor;
import org.penforge.backend.pentestScenarios.BindShellConnectService;
import org.penforge.backend.pentestScenarios.FtpBruteForceService;
import org.penforge.backend.pentestScenarios.SshBruteForceService;
import org.penforge.backend.pentestScenarios.WPAttackService;
import org.springframework.stereotype.Service;

@Service
@AllArgsConstructor
public class PentestTemplatesService {
    private final FtpBruteForceService ftpBruteForceService;
    private final SshBruteForceService sshBruteForceService;
    private final BindShellConnectService bindShellConnectService;
    private final WPAttackService wpAttackService;
    public void performPentest(String targetIp, String pentestScenario, String userId) throws Exception{

        switch (pentestScenario){
            case "ftpBruteForce":
                ftpBruteForceService.isPortOpen(targetIp,userId);
                break;
            case "sshBruteForce":
                sshBruteForceService.isPortOpen(targetIp,userId);
                break;
            case "bindShellAccess":
                bindShellConnectService.isPortOpen(targetIp,userId);
                break;
            case "wpAttack":
                wpAttackService.isPortOpen(targetIp,userId);
                break;
        }

    }





}
